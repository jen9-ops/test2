<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Hyper-Bot</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">

  <link rel="icon" href="ico.ico" />

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

  <link rel="stylesheet" href="styles.css">

  <!-- transformers.js (GPT-2) -->
  <script defer src="https://cdn.jsdelivr.net/npm/@xenova/transformers/dist/transformers.min.js"></script>
  <script defer src="app.js"></script>
</head>
<body class="d-flex flex-column h-100">

  <!-- NAVBAR -->
  <header class="navbar glass shadow-sm px-3">
    <a class="navbar-brand d-flex align-items-center gap-2 fw-bold" href="#">
      <i class="bi bi-robot"></i> Hyper-Bot
      <span id="progress"    class="badge bg-warning text-dark ms-1">0 %</span>
      <span id="aiIndicator" class="badge bg-info text-dark ms-1 d-none">GPT-2</span>
    </a>

    <div class="dropdown ms-auto">
      <button class="menu-btn" data-bs-toggle="dropdown" aria-label="Меню">
        <i class="bi bi-list fs-4"></i>
      </button>

      <ul class="dropdown-menu glass dropdown-menu-end p-2 shadow-lg">
        <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#mdlText"><i class="bi bi-file-text me-1"></i>Обучить текстом</a></li>
        <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#mdlURL"><i class="bi bi-link-45deg me-1"></i>Обучить URL</a></li>
        <li><a class="dropdown-item" href="#" onclick="showAnalysis()"><i class="bi bi-bar-chart me-1"></i>Анализ</a></li>

        <li><hr class="dropdown-divider"></li>

        <li><a class="dropdown-item" href="#" onclick="exportData()"><i class="bi bi-download me-1"></i>Скачать память</a></li>
        <li><a class="dropdown-item" href="#" onclick="document.getElementById('fileInput').click()"><i class="bi bi-upload me-1"></i>Загрузить память</a></li>
        <li><a class="dropdown-item" href="#" onclick="clearChat()"><i class="bi bi-x-circle me-1"></i>Очистить чат</a></li>
        <li><a class="dropdown-item text-danger" href="#" onclick="clearMemory()"><i class="bi bi-trash3 me-1"></i>Очистить память</a></li>

        <li><hr class="dropdown-divider"></li>

        <li><a class="dropdown-item" href="#" onclick="toggleTheme()"><i class="bi bi-moon-stars me-1"></i>Тёмная тема</a></li>
      </ul>
    </div>
  </header>

  <!-- Можно что-то выводить здесь, сейчас пусто -->
  <main class="flex-grow-1 d-flex flex-column p-3 overflow-auto"></main>

  <!-- Нижняя растягиваемая консоль -->
  <div id="consolePanel" class="console-panel glass">
    <div id="consoleHandle" class="console-handle" title="Потянуть вверх/вниз"></div>

    <div id="chat" class="chat flex-grow-1 overflow-auto"></div>

    <div class="d-flex gap-2 p-2">
      <textarea id="userInput" rows="2" class="form-control soft"
                placeholder="Shift+Enter – новая строка, Ctrl+Enter – отправить"></textarea>
      <button id="btnAsk" class="btn btn-primary">➤</button>
    </div>
  </div>

  <input id="fileInput" type="file" accept="application/json" class="d-none" onchange="importData(event)">

  <!-- MODALS -->
  <div id="mdlText" class="modal fade">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content glass p-3">
        <h5 class="modal-title mb-3"><i class="bi bi-pencil-square me-2"></i>Обучить по тексту</h5>
        <textarea id="textInput" rows="6" class="form-control soft mb-3" placeholder="Вставь текст для обучения…"></textarea>
        <div class="text-end">
          <button class="btn btn-secondary me-2" data-bs-dismiss="modal">Отмена</button>
          <button class="btn btn-primary" data-bs-dismiss="modal" onclick="trainFromText()">Обучить</button>
        </div>
      </div>
    </div>
  </div>

  <div id="mdlURL" class="modal fade">
    <div class="modal-dialog modal-md modal-dialog-centered">
      <div class="modal-content glass p-3">
        <h5 class="modal-title mb-3"><i class="bi bi-link-45deg me-2"></i>Обучить по URL</h5>
        <input id="urlInput" class="form-control soft mb-3" placeholder="https://пример.ru/статья">
        <div class="text-end">
          <button class="btn btn-secondary me-2" data-bs-dismiss="modal">Отмена</button>
          <button class="btn btn-primary" data-bs-dismiss="modal" onclick="trainFromURL()">Загрузить</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
